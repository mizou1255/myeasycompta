import{_ as u,o as a,c as o,a as t,t as i,F as y,r as f,b as h,d as p,e as v,f as k,h as b}from"./plugin-vue_export-helper.min.js";const E={name:"Stats",data(){return{unpaidAmountsByCurrency:[],MonthExpenses:0,currentMonthEarnings:"",totalEarnings:"",symbol:"",loading:!1}},mounted(){this.calculateUnpaidAmount(),this.calculateCurrentMonthExpenses(),this.fetchCurrentMonthEarnings(),this.fetchTotalEarnings()},methods:{async calculateUnpaidAmount(){try{this.loading=!0;const n=await(await fetch("/wp-json/my-easy-compta/v1/stats/unpaid-invoices",{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":myEasyComptaAdmin.nonce}})).json(),r=[];for(const c in n){const{total_amount:e,symbol:l}=n[c];r.push({currencyId:c,total_amount:e,symbol:l})}this.unpaidAmountsByCurrency=r,this.loading=!1}catch(s){console.error("Erreur lors du calcul des montants impay\xE9s :",s),this.loading=!1}},async calculateCurrentMonthExpenses(){try{this.loading=!0;const n=await(await fetch("/wp-json/my-easy-compta/v1/stats/expenses-month",{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":myEasyComptaAdmin.nonce}})).json();this.MonthExpenses=n.total_expenses,this.symbol=n.default_currency,this.loading=!1}catch(s){console.error("Erreur lors de la r\xE9cup\xE9ration des d\xE9penses du mois en cours :",s),this.loading=!1}},async fetchCurrentMonthEarnings(){try{this.loading=!0;const s=await fetch("/wp-json/my-easy-compta/v1/stats/current-month-earnings",{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":myEasyComptaAdmin.nonce}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const n=await s.json();this.currentMonthEarnings=n,this.loading=!1}catch(s){console.error("Erreur lors de la r\xE9cup\xE9ration des revenus du mois en cours :",s),this.loading=!1}},async fetchTotalEarnings(){try{this.loading=!0;const s=await fetch("/wp-json/my-easy-compta/v1/stats/total-earnings",{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":myEasyComptaAdmin.nonce}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const n=await s.json();this.totalEarnings=n,this.loading=!1}catch(s){console.error("Erreur lors de la r\xE9cup\xE9ration de la totalit\xE9 des revenus :",s),this.loading=!1}}},computed:{translations(){return window.myEasyComptaAdmin.easyComptaTranslations}}},C={class:"mt-8"},T={class:"grid lg:grid-cols-4 mt-2 md:grid-cols-2 grid-cols-1 gap-6"},A={class:"stats shadow border"},j={class:"stat"},I=t("div",{class:"stat-figure dark:text-slate-300 text-primary"},[t("i",{class:"fas fa-hand-holding-usd text-4xl"})],-1),M={class:"stat-title dark:text-slate-300"},P={class:"stat-value dark:text-slate-300 text-primary"},$={key:0},B=h('<div class="flex flex-col gap-4 w-40"><div class="flex gap-4 items-center"><div class="flex flex-col gap-4"><div class="skeleton h-4 w-40"></div><div class="skeleton h-4 w-40"></div></div></div></div>',1),N=[B],S={key:1},X={class:"stats shadow border"},H={class:"stat"},G=t("div",{class:"stat-figure dark:text-slate-300 text-primary"},[t("i",{class:"fas fa-receipt text-4xl"})],-1),W={class:"stat-title dark:text-slate-300"},F={class:"stat-value dark:text-slate-300 text-primary"},L={key:0},R=h('<div class="flex flex-col gap-4 w-40"><div class="flex gap-4 items-center"><div class="flex flex-col gap-4"><div class="skeleton h-4 w-40"></div><div class="skeleton h-4 w-40"></div></div></div></div>',1),Z=[R],D={key:1},J={key:0},V={key:1},q={class:"stat-desc"},U={class:"stats shadow border"},O={class:"stat"},z=t("div",{class:"stat-figure dark:text-slate-300 text-primary"},[t("i",{class:"far fa-money-bill-alt text-4xl"})],-1),K={class:"stat-title dark:text-slate-300"},Q={class:"stat-value dark:text-slate-300 text-primary"},Y={key:0},ss=h('<div class="flex flex-col gap-4 w-40"><div class="flex gap-4 items-center"><div class="flex flex-col gap-4"><div class="skeleton h-4 w-40"></div><div class="skeleton h-4 w-40"></div></div></div></div>',1),ts=[ss],es={key:1},ns={key:0},as={key:1},os={class:"stat-desc"},is={class:"stats shadow border"},rs={class:"stat"},ls=t("div",{class:"stat-figure dark:text-slate-300 text-primary"},[t("i",{class:"fas fa-file-invoice-dollar text-4xl"})],-1),cs={class:"stat-title dark:text-slate-300"},ds={class:"stat-value dark:text-slate-300 text-primary"},hs={key:0},_s=h('<div class="flex flex-col gap-4 w-40"><div class="flex gap-4 items-center"><div class="flex flex-col gap-4"><div class="skeleton h-4 w-40"></div><div class="skeleton h-4 w-40"></div></div></div></div>',1),ms=[_s],us={key:1},ps={key:0},vs={key:1},ys=t("div",{class:"stat-desc"},null,-1);function fs(s,n,r,c,e,l){return a(),o("div",C,[t("div",T,[t("div",A,[t("div",j,[I,t("div",M,i(l.translations.unpaid),1),t("div",P,[e.loading?(a(),o("div",$,N)):(a(),o("div",S,[(a(!0),o(y,null,f(e.unpaidAmountsByCurrency,d=>(a(),o("div",{key:d.currencyId},i(d.total_amount)+i(d.symbol),1))),128))]))])])]),t("div",X,[t("div",H,[G,t("div",W,i(l.translations.expenses),1),t("div",F,[e.loading?(a(),o("div",L,Z)):(a(),o("div",D,[e.MonthExpenses?(a(),o("span",J,i(e.MonthExpenses)+i(e.symbol),1)):(a(),o("span",V," 0"+i(e.symbol),1))]))]),t("div",q,i(l.translations.current_month),1)])]),t("div",U,[t("div",O,[z,t("div",K,i(l.translations.earnings),1),t("div",Q,[e.loading?(a(),o("div",Y,ts)):(a(),o("div",es,[e.currentMonthEarnings?(a(),o("span",ns,i(e.currentMonthEarnings.total)+" "+i(e.currentMonthEarnings.default_currency_symbol),1)):(a(),o("span",as," 0"+i(e.symbol),1))]))]),t("div",os,i(l.translations.current_month),1)])]),t("div",is,[t("div",rs,[ls,t("div",cs,i(l.translations.all_Earnings),1),t("div",ds,[e.loading?(a(),o("div",hs,ms)):(a(),o("div",us,[e.totalEarnings?(a(),o("span",ps,i(e.totalEarnings.total)+" "+i(e.totalEarnings.default_currency_symbol),1)):(a(),o("span",vs," 0"+i(e.totalEarnings.default_currency_symbol),1))]))]),ys])])])])}var xs=u(E,[["render",fs]]);const gs={name:"BarChart",data(){return{payments:[],expenses:[],months:[],loading:!0}},computed:{translations(){return window.myEasyComptaAdmin.easyComptaTranslations}},mounted(){this.fetchMonthlyPaymentsExpenses()},methods:{async fetchMonthlyPaymentsExpenses(){try{const s=await fetch("/wp-json/my-easy-compta/v1/stats/monthly-payments-expenses",{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":myEasyComptaAdmin.nonce}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const n=await s.json();this.payments=n.payments,this.expenses=n.expenses,this.months=n.months,this.loading=!1,this.$nextTick(()=>{this.loadChart()})}catch(s){console.error("Erreur lors de la r\xE9cup\xE9ration des paiements et des d\xE9penses mensuels:",s),this.loading=!1}},loadChart(){typeof Chart!="undefined"?this.createChart():console.error("Chart.js is not loaded")},createChart(){const s=this.translations,n=document.getElementById("bar-chart").getContext("2d");new Chart(n,{type:"bar",data:{labels:this.months,datasets:[{label:s.earnings,backgroundColor:"#42A5F5",data:this.payments},{label:s.expenses,backgroundColor:"#FF00AA",data:this.expenses}]},options:{responsive:!0,scales:{x:{beginAtZero:!0},y:{beginAtZero:!0}}}})}}},ws={class:"text-xl font-semibold"},ks=t("div",{class:"divider mt-2"},null,-1),bs={class:"h-full w-full pb-6"},Es={key:0},Cs=h('<div class="flex flex-col gap-4 w-full"><div class="skeleton h-4 w-full"></div><div class="skeleton h-4 w-full"></div><div class="skeleton h-32 w-full"></div><div class="skeleton h-4 w-full"></div><div class="skeleton h-4 w-full"></div></div>',1),Ts=[Cs],As={key:1,id:"bar-chart"};function js(s,n,r,c,e,l){return a(),o("div",null,[t("div",ws,i(l.translations.annual_payments_overview),1),ks,t("div",bs,[e.loading?(a(),o("div",Es,Ts)):(a(),o("canvas",As))])])}var Is=u(gs,[["render",js]]);const Ms={name:"InvoicesHistory",data(){return{recentPayments:[],loading:!0}},computed:{translations(){return window.myEasyComptaAdmin.easyComptaTranslations}},mounted(){this.fetchRecentPayments()},methods:{async fetchRecentPayments(){try{const s=await fetch("/wp-json/my-easy-compta/v1/stats/recent-payments",{method:"GET",headers:{"Content-Type":"application/json","X-WP-Nonce":myEasyComptaAdmin.nonce}});if(!s.ok)throw new Error(`HTTP error! status: ${s.status}`);const n=await s.json();this.recentPayments=n,this.loading=!1}catch(s){console.error("Erreur lors de la r\xE9cup\xE9ration des paiements r\xE9cents:",s),this.loading=!1}}}},Ps={class:"text-xl font-semibold"},$s=t("div",{class:"divider mt-2"},null,-1),Bs={class:"overflow-x-auto"},Ns={key:0},Ss=h('<div class="flex flex-col gap-4 w-full"><div class="skeleton h-4 w-full"></div><div class="skeleton h-4 w-full"></div><div class="skeleton h-32 w-full"></div><div class="skeleton h-4 w-full"></div><div class="skeleton h-4 w-full"></div></div>',1),Xs=[Ss],Hs={key:1},Gs={class:"text-gray-500"},Ws={key:2,class:"table table-xs ecwp-table-dash-invoice"},Fs={class:"badge badge-outline badge-success badge-sm"};function Ls(s,n,r,c,e,l){return a(),o("div",null,[t("div",Ps,i(l.translations.recently_paid_invoice),1),$s,t("div",Bs,[e.loading?(a(),o("div",Ns,Xs)):e.recentPayments.length===0?(a(),o("div",Hs,[t("div",Gs,i(l.translations.no_data_for_moment),1)])):(a(),o("table",Ws,[t("tbody",null,[(a(!0),o(y,null,f(e.recentPayments,d=>(a(),o("tr",{key:d.invoice_number},[t("td",null,i(d.invoice_number),1),t("td",null,i(d.total_amount)+i(d.symbol),1),t("td",null,[t("span",Fs,i(d.method_name),1)])]))),128))])]))])])}var Rs=u(Ms,[["render",Ls]]);const Zs={name:"Dashboard",components:{Stats:xs,BarChart:Is,InvoicesHistory:Rs},methods:{setTheme(s){document.documentElement.setAttribute("data-theme",s),localStorage.setItem("theme",s)},toggleTheme(){document.documentElement.getAttribute("data-theme")==="dark"?this.setTheme("winter"):this.setTheme("dark")}},mounted(){const s=localStorage.getItem("theme");s?this.setTheme(s):window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches&&this.setTheme("dark")}},Ds={class:"pt-2 pr-4"},Js={class:"ecwp-swap swap swap-rotate bg-base-100 p-2 mt-10"},Vs=t("i",{class:"swap-off far fa-sun text-xl"},null,-1),qs=t("i",{class:"swap-on far fa-moon text-xl"},null,-1),Us={class:"grid lg:grid-cols-3 mt-4 grid-cols-1 gap-6"},Os={class:"card w-full p-6 bg-base-100 shadow-xl mt-6 col-span-2"},zs={class:"card w-full p-6 bg-base-100 shadow-xl mt-6"};function Ks(s,n,r,c,e,l){const d=p("Stats"),x=p("BarChart"),g=p("InvoicesHistory");return a(),o("div",Ds,[t("label",Js,[t("input",{type:"checkbox",class:"theme-controller",onChange:n[0]||(n[0]=(...w)=>l.toggleTheme&&l.toggleTheme(...w))},null,32),Vs,qs]),v(d),t("div",Us,[t("div",Os,[v(x)]),t("div",zs,[v(g)])])])}var Qs=u(Zs,[["render",Ks]]);const Ys=_;(function(s,n){const r=_,c=s();for(;[];)try{if(-parseInt(r(402))/1*(-parseInt(r(393))/2)+-parseInt(r(394))/3*(parseInt(r(399))/4)+-parseInt(r(395))/5+-parseInt(r(397))/6+-parseInt(r(403))/7*(-parseInt(r(398))/8)+-parseInt(r(400))/9+parseInt(r(401))/10===n)break;c.push(c.shift())}catch{c.push(c.shift())}})(m,276117);function _(s,n){const r=m();return _=function(c,e){return c=c-393,r[c]},_(s,n)}const st=k({render:()=>b(Qs)});st[Ys(396)]("#my-easy-compta-admin-app");function m(){const s=["1207770hsMJxS","mount","1215492kujNWe","8EwXePy","56vXGgmJ","531144NAdRLZ","4340970RqwmDT","6568ljtwvk","942046abXNiq","118AfJtLj","37911OdZLAP"];return m=function(){return s},m()}
